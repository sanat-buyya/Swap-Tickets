<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Sell Ticket</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="icon" href="/docs/swaplogo.png" type="image/png">
    <style>
        :root {
            --primary-color: #4a6bff;
            --secondary-color: #f8f9fa;
            --accent-color: #ff6b6b;
            --text-color: #333;
            --light-gray: #e9ecef;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            background-image: url('https://www.transparenttextures.com/patterns/cubes.png');
        }

        h1, h2, h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            margin: 20px 0;
            font-size: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .steps-link {
            color: #4285f4;
            text-decoration: none;
            font-weight: bold;
        }

        .steps-link:hover {
            text-decoration: underline;
        }

        .form-container {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .form-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }

        .form-section:last-child {
            border-bottom: none;
        }

        .form-group {
            margin-bottom: 18px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 15px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 15px;
            transition: border 0.3s ease;
        }

        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 107, 255, 0.1);
        }

        /* Autocomplete Dropdown Styles */
        .autocomplete-container {
            position: relative;
        }

        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 6px 6px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .autocomplete-suggestion {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
        }

        .autocomplete-suggestion:hover,
        .autocomplete-suggestion.highlighted {
            background-color: var(--secondary-color);
        }

        .autocomplete-suggestion:last-child {
            border-bottom: none;
        }

        .station-code {
            font-weight: 600;
            color: var(--primary-color);
        }

        .station-name {
            font-size: 14px;
            color: #666;
            margin-left: 8px;
        }

        .passenger-block {
            background: var(--secondary-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
            position: relative;
        }

        .remove-passenger {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--accent-color);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 15px;
            position: relative;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #3a5bef;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
            min-width: 180px;
            position: relative;
        }

        .btn-success:hover:not(:disabled) {
            background-color: #218838;
            transform: translateY(-2px);
        }

        .btn-success:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .btn-add {
            background-color: var(--info-color);
            color: white;
            margin-bottom: 20px;
        }

        .btn-add:hover {
            background-color: #138496;
        }

        .terms-checkbox {
            display: flex;
            align-items: center;
            margin: 20px 0;
            font-size: 14px;
        }

        .terms-checkbox input {
            width: auto;
            margin-right: 10px;
        }

        .note {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type="file"] {
            font-size: 100px;
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
        }

        .file-input-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: 1px dashed var(--border-color);
            padding: 30px;
            border-radius: 6px;
            text-align: center;
            background: var(--secondary-color);
            color: #666;
            font-weight: 500;
        }

        .file-input-btn:hover {
            background: #e9ecef;
        }

        .file-name {
            margin-top: 5px;
            font-size: 13px;
            color: var(--primary-color);
            display: none;
        }

        /* Loader Animation Styles */
        .loader {
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid #ffffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .btn-text {
            transition: opacity 0.3s ease;
        }

        .btn-loading .btn-text {
            opacity: 0;
        }

        .btn-loading .loader {
            display: block;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        /* Number of Tickets Styling */
        .ticket-count-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ticket-count-input {
            max-width: 80px;
            text-align: center;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            .form-container {
                padding: 20px;
            }
            h1 {
                font-size: 1.7rem;
            }
            input, select, textarea {
                padding: 10px 12px;
            }
            .passenger-block {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            .form-container {
                padding: 15px;
            }
            h1 {
                font-size: 1.5rem;
            }
            .btn {
                padding: 10px 15px;
                font-size: 14px;
            }
            .ticket-count-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            .ticket-count-input {
                max-width: 100%;
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .passenger-block {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>

<body>
    <h1><i class="fas fa-ticket-alt"></i> Sell Your Ticket</h1>
    
    <div class="form-container">
        <form th:action="@{/pnr/sell}" method="post" enctype="multipart/form-data" id="sellTicketForm">
            <!-- PNR + Train Info -->
            <div class="form-section">
                <h3><i class="fas fa-train"></i> Journey Details</h3>
                
                <div class="form-group">
                    <label for="pnrNumber">PNR Number</label>
                    <input type="text" id="pnrNumber" name="pnrNumber" pattern="\d{10}" title="PNR must be exactly 10 digits" required>
                </div>

                <div class="form-group">
                    <label for="trainNumber">Train Number</label>
                    <input type="text" id="trainNumber" name="trainNumber" required>
                </div>

                <div class="form-group">
                    <label for="fromStation">From Station</label>
                    <div class="autocomplete-container">
                        <input type="text" id="fromStation" name="fromStation" placeholder="Enter station name or code" required autocomplete="off">
                        <div class="autocomplete-suggestions" id="fromStationSuggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="toStation">To Station</label>
                    <div class="autocomplete-container">
                        <input type="text" id="toStation" name="toStation" placeholder="Enter station name or code" required autocomplete="off">
                        <div class="autocomplete-suggestions" id="toStationSuggestions"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="journeyDate">Journey Date</label>
                    <input type="date" id="journeyDate" name="journeyDate" th:min="${T(java.time.LocalDate).now()}" required>
                </div>

                <div class="form-group">
                    <label for="numberOfTickets">Number of Passengers</label>
                    <div class="ticket-count-container">
                        <input type="number" id="numberOfTickets" name="numberOfTickets" min="1" max="6" value="1" class="ticket-count-input" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>Ticket Image</label>
                    <div class="file-input-wrapper">
                        <div class="file-input-btn">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Click to upload ticket image</span>
                        </div>
                        <input type="file" name="ticketImage" accept=".jpg,.jpeg,.png,.pdf" required onchange="showFileName(this)">
                    </div>
                    <div class="file-name" id="ticketFileName"></div>
                </div>
            </div>

            <!-- Seller Info -->
            <div class="form-section">
                <h3><i class="fas fa-user-circle"></i> Seller Information</h3>
                
                <div class="form-group">
                    <label for="sellerMobile">Mobile Number</label>
                    <input type="tel" id="sellerMobile" name="sellerMobile" placeholder="Enter Mobile Number" pattern="[0-9]{10}" required>
                </div>

                <div class="form-group">
                    <label for="upiId">UPI ID</label>
                    <input type="text" id="upiId" name="upiId" placeholder="Enter Your UPI Id" required>
                    <div class="note">For receiving payment after journey completion</div>
                </div>

                <div class="terms-checkbox">
                                        <input type="checkbox" id="acceptUpi" name="acceptUpi" required>
                    <label for="acceptUpi"> Confirm Your UPI Number</label>
                </div>
            </div>

            <!-- Passenger Details -->
            <div class="form-section">
                <h3><i class="fas fa-users"></i> Passenger Details</h3>
                <p class="note">Add details for each passenger on the ticket</p>
                <div id="passenger-container"></div>
                <button type="button" class="btn btn-add" onclick="addPassenger()">
                    <i class="fas fa-plus"></i> Add Passenger
                </button>
            </div>

            <!-- Terms and Submit -->
            <div class="terms-checkbox">
                <input type="checkbox" id="acceptTerms" name="acceptTerms" required>
                <label for="acceptTerms">I accept the <a href="/terms">Terms and Conditions</a></label>
            </div>

            <p class="note">
                <i class="fas fa-info-circle"></i> Check your ticket status in My Tickets. Payment will be transferred after journey completion.
            </p>

            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" class="btn btn-success" id="submitBtn">
                    <div class="loader"></div>
                    <span class="btn-text">
                        <i class="fas fa-paper-plane"></i> Submit Ticket
                    </span>
                </button>
            </div>
        </form>
    </div>

    <div style="text-align: center; margin-top: 20px;">
        <a th:href="@{/user/home}">
            <button class="btn btn-secondary"> Back to Home</button>
        </a>
    </div>

    <script>
        let passengerCount = 0;

        // Indian Railway Stations Database (sample - you can expand this)
        const indianStations = [
        	// 🏙️ KARNATAKA REGION (Major Hub)
            { name: "Bangalore City Junction", code: "SBC", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Bangalore City Junction", code: "KSR", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Bangalore East", code: "BNCE", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Bangalore Cantonment", code: "BNC", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Yeshwantpur Junction", code: "YPR", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Krishnarajapuram", code: "KJM", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Whitefield", code: "WFD", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Baiyappanahalli", code: "BYPL", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            { name: "Yelahanka Junction", code: "YNK", state: "Karnataka", district: "Bangalore Urban", zone: "SWR" },
            
            // 🌊 COASTAL KARNATAKA
            { name: "Mangalore Central", code: "MAQ", state: "Karnataka", district: "Dakshina Kannada", zone: "KR" },
            { name: "Mangalore Junction", code: "MAJN", state: "Karnataka", district: "Dakshina Kannada", zone: "KR" },
            { name: "Surathkal", code: "SL", state: "Karnataka", district: "Dakshina Kannada", zone: "KR" },
            { name: "Udupi", code: "UD", state: "Karnataka", district: "Udupi", zone: "KR" },
            { name: "Kundapura", code: "KUDA", state: "Karnataka", district: "Udupi", zone: "KR" },
            { name: "Karwar", code: "KAWR", state: "Karnataka", district: "Uttara Kannada", zone: "KR" },
            { name: "Kumta", code: "KT", state: "Karnataka", district: "Uttara Kannada", zone: "KR" },
            { name: "Murdeshwar", code: "MRDW", state: "Karnataka", district: "Uttara Kannada", zone: "KR" },
            
            { name: "Mysore Junction", code: "MYS", state: "Karnataka", district: "Mysore", zone: "SWR" },
            { name: "Mandya", code: "MYA", state: "Karnataka", district: "Mandya", zone: "SWR" },
            { name: "Maddur", code: "MAD", state: "Karnataka", district: "Mandya", zone: "SWR" },
            { name: "Channapatna", code: "CPT", state: "Karnataka", district: "Ramanagara", zone: "SWR" },
            { name: "Ramanagara", code: "RMGM", state: "Karnataka", district: "Ramanagara", zone: "SWR" },
            { name: "Kengeri", code: "KGI", state: "Karnataka", district: "Bangalore Rural", zone: "SWR" },
            { name: "Bidadi", code: "BDDI", state: "Karnataka", district: "Ramanagara", zone: "SWR" },
            { name: "Srirangapatna", code: "SRGP", state: "Karnataka", district: "Mandya", zone: "SWR" },
            { name: "Pandavapura", code: "PVR", state: "Karnataka", district: "Mandya", zone: "SWR" },
            { name: "Melukote", code: "MELT", state: "Karnataka", district: "Mandya", zone: "SWR" },

            // 🏭 NORTH KARNATAKA (Industrial Belt)
            { name: "Hubli Junction", code: "UBL", state: "Karnataka", district: "Dharwad", zone: "SWR" },
            { name: "Dharwad", code: "DWR", state: "Karnataka", district: "Dharwad", zone: "SWR" },
            { name: "Belgaum", code: "BGM", state: "Karnataka", district: "Belgaum", zone: "SWR" },
            { name: "Gadag Junction", code: "GDG", state: "Karnataka", district: "Gadag", zone: "SWR" },
            { name: "Koppal", code: "KBL", state: "Karnataka", district: "Koppal", zone: "SWR" },
            { name: "Hospet Junction", code: "HPT", state: "Karnataka", district: "Bellary", zone: "SWR" },
            { name: "Bellary Junction", code: "BAY", state: "Karnataka", district: "Bellary", zone: "SWR" },
            { name: "Raichur Junction", code: "RC", state: "Karnataka", district: "Raichur", zone: "SWR" },
            { name: "Bijapur", code: "BJP", state: "Karnataka", district: "Bijapur", zone: "SWR" },
            { name: "Bagalkot", code: "BGK", state: "Karnataka", district: "Bagalkot", zone: "SWR" },
            // 🏔️ NORTH-EAST KARNATAKA
            { name: "Bidar", code: "BIDR", state: "Karnataka", district: "Bidar", zone: "SWR" },
            { name: "Gulbarga", code: "GR", state: "Karnataka", district: "Gulbarga", zone: "SWR" },
            { name: "Yadgir", code: "YG", state: "Karnataka", district: "Yadgir", zone: "SWR" },
            { name: "Jewargi Junction", code: "JWO", state: "Karnataka", district: "Gulbarga", zone: "SWR" },
            { name: "Shahabad", code: "SDB", state: "Karnataka", district: "Gulbarga", zone: "SWR" },
            { name: "Wadi Junction", code: "WADI", state: "Karnataka", district: "Gulbarga", zone: "SWR" },
            
            // 🌿 SOUTH KARNATAKA
            { name: "Hassan Junction", code: "HAS", state: "Karnataka", district: "Hassan", zone: "SWR" },
            { name: "Arsikere Junction", code: "ASK", state: "Karnataka", district: "Hassan", zone: "SWR" },
            { name: "Tumkur", code: "TK", state: "Karnataka", district: "Tumkur", zone: "SWR" },
            { name: "Davangere", code: "DVG", state: "Karnataka", district: "Davangere", zone: "SWR" },
            { name: "Chitradurga", code: "CTA", state: "Karnataka", district: "Chitradurga", zone: "SWR" },
            { name: "Kolar Gold Fields", code: "KGF", state: "Karnataka", district: "Kolar", zone: "SWR" },
            { name: "Chikballapur", code: "CBP", state: "Karnataka", district: "Chikballapur", zone: "SWR" },
            { name: "Shimoga Town", code: "SMET", state: "Karnataka", district: "Shimoga", zone: "SWR" },
            { name: "Chikmagalur", code: "CMG", state: "Karnataka", district: "Chikmagalur", zone: "SWR" },
            
            // 🏛️ DELHI & NCR
            { name: "New Delhi", code: "NDLS", state: "Delhi", district: "New Delhi", zone: "NR" },
            { name: "Delhi Junction", code: "DLI", state: "Delhi", district: "Delhi", zone: "NR" },
            { name: "Hazrat Nizamuddin", code: "NZM", state: "Delhi", district: "New Delhi", zone: "NR" },
            { name: "Delhi Sarai Rohilla", code: "DEE", state: "Delhi", district: "Delhi", zone: "NR" },
            { name: "Anand Vihar Terminal", code: "ANVT", state: "Delhi", district: "Delhi", zone: "NR" },
            { name: "Gurgaon", code: "GGN", state: "Haryana", district: "Gurgaon", zone: "NR" },
            { name: "Faridabad", code: "FDB", state: "Haryana", district: "Faridabad", zone: "NR" },
            { name: "Ghaziabad", code: "GZB", state: "Uttar Pradesh", district: "Ghaziabad", zone: "NR" },
            
            // 🏙️ MUMBAI & MAHARASHTRA
            { name: "Mumbai Central", code: "MMCT", state: "Maharashtra", district: "Mumbai", zone: "WR" },
            { name: "Chhatrapati Shivaji Terminus", code: "CSMT", state: "Maharashtra", district: "Mumbai", zone: "CR" },
            { name: "Lokmanya Tilak Terminus", code: "LTT", state: "Maharashtra", district: "Mumbai", zone: "CR" },
            { name: "Dadar", code: "DR", state: "Maharashtra", district: "Mumbai", zone: "CR" },
            { name: "Pune Junction", code: "PUNE", state: "Maharashtra", district: "Pune", zone: "CR" },
            { name: "Nashik Road", code: "NK", state: "Maharashtra", district: "Nashik", zone: "CR" },
            { name: "Nagpur Junction", code: "NGP", state: "Maharashtra", district: "Nagpur", zone: "SECR" },
            { name: "Aurangabad", code: "AWB", state: "Maharashtra", district: "Aurangabad", zone: "SCR" },
            { name: "Solapur", code: "SUR", state: "Maharashtra", district: "Solapur", zone: "CR" },
            
            // 🌴 CHENNAI & TAMIL NADU
            { name: "Chennai Central", code: "MAS", state: "Tamil Nadu", district: "Chennai", zone: "SR" },
            { name: "Chennai Egmore", code: "MS", state: "Tamil Nadu", district: "Chennai", zone: "SR" },
            { name: "Coimbatore Junction", code: "CBE", state: "Tamil Nadu", district: "Coimbatore", zone: "SR" },
            { name: "Madurai Junction", code: "MDU", state: "Tamil Nadu", district: "Madurai", zone: "SR" },
            { name: "Tiruchirapalli", code: "TPJ", state: "Tamil Nadu", district: "Tiruchirappalli", zone: "SR" },
            { name: "Salem Junction", code: "SA", state: "Tamil Nadu", district: "Salem", zone: "SR" },
            { name: "Erode Junction", code: "ED", state: "Tamil Nadu", district: "Erode", zone: "SR" },
            { name: "Tirunelveli", code: "TEN", state: "Tamil Nadu", district: "Tirunelveli", zone: "SR" },
            { name: "Kanyakumari", code: "CAPE", state: "Tamil Nadu", district: "Kanyakumari", zone: "SR" },
            
            // 🌊 KERALA
            { name: "Thiruvananthapuram Central", code: "TVC", state: "Kerala", district: "Thiruvananthapuram", zone: "SR" },
            { name: "Ernakulam Junction", code: "ERS", state: "Kerala", district: "Ernakulam", zone: "SR" },
            { name: "Kozhikode", code: "CLT", state: "Kerala", district: "Kozhikode", zone: "SR" },
            { name: "Thrissur", code: "TCR", state: "Kerala", district: "Thrissur", zone: "SR" },
            { name: "Kannur", code: "CAN", state: "Kerala", district: "Kannur", zone: "SR" },
            { name: "Kollam Junction", code: "QLN", state: "Kerala", district: "Kollam", zone: "SR" },
            { name: "Palakkad Junction", code: "PGT", state: "Kerala", district: "Palakkad", zone: "SR" },
            { name: "Kottayam", code: "KTYM", state: "Kerala", district: "Kottayam", zone: "SR" },
            { name: "Alappuzha", code: "ALLP", state: "Kerala", district: "Alappuzha", zone: "SR" },
            
            // 🏛️ HYDERABAD & TELANGANA
            { name: "Hyderabad Deccan", code: "HYB", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "A1" },
    		{ name: "Secunderabad Junction", code: "SC", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "A1" },
    		{ name: "Kacheguda", code: "KCG", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "A" },
    		{ name: "Begumpet", code: "BMT", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "B" },
    		{ name: "Lingampalli", code: "LPI", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "B" },
    		{ name: "Hi-Tech City", code: "HTC", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "B" },
    		{ name: "Bolarum", code: "BMO", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Falaknuma", code: "FM", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "B" },
    		{ name: "Malakpet", code: "MXT", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Yakutpura", code: "YKA", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Dabirpura", code: "DQR", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Nampally", code: "NMP", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Sitafalmandi", code: "STPD", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    		{ name: "Lallaguda", code: "LGDH", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    { name: "Cherlapalli", code: "CHZ", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    { name: "Ghatkesar", code: "GKS", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "C" },
    { name: "Bolaram Bazar", code: "BOZ", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "D" },
    { name: "Alwal", code: "ALW", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "D" },
    { name: "Sanathnagar", code: "SNF", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "D" },
    { name: "Moula Ali", code: "MOB", state: "Telangana", district: "Hyderabad", zone: "SCR", category: "D" },

    // 🏭 WARANGAL DIVISION
    { name: "Warangal", code: "WL", state: "Telangana", district: "Warangal Urban", zone: "SCR", category: "A" },
    { name: "Kazipet Junction", code: "KZJ", state: "Telangana", district: "Warangal Urban", zone: "SCR", category: "A" },
    { name: "Hanamkonda", code: "HNK", state: "Telangana", district: "Warangal Urban", zone: "SCR", category: "B" },
    { name: "Mahbubabad", code: "MABD", state: "Telangana", district: "Mahabubabad", zone: "SCR", category: "B" },
    { name: "Dornakal Junction", code: "DKJ", state: "Telangana", district: "Mahabubabad", zone: "SCR", category: "B" },
    { name: "Kesamudram", code: "KDM", state: "Telangana", district: "Mahabubabad", zone: "SCR", category: "C" },
    { name: "Garladinne", code: "GLA", state: "Telangana", district: "Warangal Rural", zone: "SCR", category: "C" },
    { name: "Thallada", code: "TDD", state: "Telangana", district: "Warangal Rural", zone: "SCR", category: "D" },
    { name: "Hasanparthi Road", code: "HSP", state: "Telangana", district: "Warangal Rural", zone: "SCR", category: "D" },
    { name: "Parkal", code: "PKL", state: "Telangana", district: "Warangal Rural", zone: "SCR", category: "D" },

    // 🌾 KHAMMAM DIVISION
    { name: "Khammam", code: "KMT", state: "Telangana", district: "Khammam", zone: "SCR", category: "A" },
    { name: "Madhira", code: "MDR", state: "Telangana", district: "Khammam", zone: "SCR", category: "B" },
    { name: "Wyra", code: "WYR", state: "Telangana", district: "Khammam", zone: "SCR", category: "C" },
    { name: "Nelakondapalli", code: "NKD", state: "Telangana", district: "Khammam", zone: "SCR", category: "C" },
    { name: "Mudigonda", code: "MDG", state: "Telangana", district: "Khammam", zone: "SCR", category: "C" },
    { name: "Kalluru", code: "KLU", state: "Telangana", district: "Khammam", zone: "SCR", category: "D" },
    { name: "Kothagudem Town", code: "KDGM", state: "Telangana", district: "Bhadradri Kothagudem", zone: "SCR", category: "B" },
    { name: "Yellandu", code: "YLU", state: "Telangana", district: "Bhadradri Kothagudem", zone: "SCR", category: "C" },
    { name: "Manuguru", code: "MANU", state: "Telangana", district: "Bhadradri Kothagudem", zone: "SCR", category: "C" },
    { name: "Sathupalli", code: "STPL", state: "Telangana", district: "Khammam", zone: "SCR", category: "C" },

    // 🏛️ NIZAMABAD DIVISION
    { name: "Nizamabad", code: "NZB", state: "Telangana", district: "Nizamabad", zone: "SCR", category: "A" },
    { name: "Kamareddy", code: "KMC", state: "Telangana", district: "Kamareddy", zone: "SCR", category: "B" },
    { name: "Bodhan", code: "BDN", state: "Telangana", district: "Nizamabad", zone: "SCR", category: "B" },
    { name: "Armoor", code: "AMQ", state: "Telangana", district: "Nizamabad", zone: "SCR", category: "C" },
    { name: "Metpalli", code: "MET", state: "Telangana", district: "Nizamabad", zone: "SCR", category: "C" },
    { name: "Nizamabad South", code: "NZBD", state: "Telangana", district: "Nizamabad", zone: "SCR", category: "C" },
    { name: "Banswada", code: "BSWD", state: "Telangana", district: "Kamareddy", zone: "SCR", category: "C" },
    { name: "Yellareddy", code: "YEA", state: "Telangana", district: "Kamareddy", zone: "SCR", category: "D" },
    { name: "Pitlam", code: "PTLM", state: "Telangana", district: "Kamareddy", zone: "SCR", category: "D" },

    // 🌸 ADILABAD DIVISION
    { name: "Adilabad", code: "ADB", state: "Telangana", district: "Adilabad", zone: "SCR", category: "B" },
    { name: "Sirpur Town", code: "SKZR", state: "Telangana", district: "Komaram Bheem", zone: "SCR", category: "C" },
    { name: "Mancherial", code: "MCI", state: "Telangana", district: "Mancherial", zone: "SCR", category: "B" },
    { name: "Bellampalli", code: "BLMP", state: "Telangana", district: "Mancherial", zone: "SCR", category: "C" },
    { name: "Mandamarri", code: "MDMR", state: "Telangana", district: "Mancherial", zone: "SCR", category: "C" },
    { name: "Luxettipet", code: "LXD", state: "Telangana", district: "Mancherial", zone: "SCR", category: "C" },
    { name: "Ramagundam", code: "RDM", state: "Telangana", district: "Peddapalli", zone: "SCR", category: "B" },
    { name: "Peddapalli", code: "PDPL", state: "Telangana", district: "Peddapalli", zone: "SCR", category: "B" },
    { name: "Manthani", code: "MCI", state: "Telangana", district: "Peddapalli", zone: "SCR", category: "C" },
    { name: "Raghavapuram", code: "RGP", state: "Telangana", district: "Peddapalli", zone: "SCR", category: "D" },

    // 🏞️ KARIMNAGAR DIVISION
    { name: "Karimnagar", code: "KRMR", state: "Telangana", district: "Karimnagar", zone: "SCR", category: "B" },
    { name: "Peddapalli Junction", code: "PDPL", state: "Telangana", district: "Peddapalli", zone: "SCR", category: "B" },
    { name: "Jammikunta", code: "JMK", state: "Telangana", district: "Karimnagar", zone: "SCR", category: "C" },
    { name: "Huzurabad", code: "HZD", state: "Telangana", district: "Karimnagar", zone: "SCR", category: "C" },
    { name: "Vemulawada", code: "VMA", state: "Telangana", district: "Rajanna Sircilla", zone: "SCR", category: "C" },
    { name: "Sircilla", code: "SRCL", state: "Telangana", district: "Rajanna Sircilla", zone: "SCR", category: "C" },
    { name: "Choppadandi", code: "CHPD", state: "Telangana", district: "Karimnagar", zone: "SCR", category: "D" },
    { name: "Koratla", code: "KTL", state: "Telangana", district: "Jagtial", zone: "SCR", category: "C" },
    { name: "Jagtial", code: "JGTL", state: "Telangana", district: "Jagtial", zone: "SCR", category: "C" },
    { name: "Metpalli Halt", code: "MTPI", state: "Telangana", district: "Jagtial", zone: "SCR", category: "D" },

    // 🌾 MEDAK DIVISION
    { name: "Medak", code: "MED", state: "Telangana", district: "Medak", zone: "SCR", category: "B" },
    { name: "Sangareddy", code: "SGRL", state: "Telangana", district: "Medak", zone: "SCR", category: "B" },
    { name: "Patancheru", code: "PTC", state: "Telangana", district: "Medak", zone: "SCR", category: "C" },
    { name: "Vikarabad Junction", code: "VKB", state: "Telangana", district: "Vikarabad", zone: "SCR", category: "B" },
    { name: "Tandur", code: "TDU", state: "Telangana", district: "Vikarabad", zone: "SCR", category: "C" },
    { name: "Zahirabad", code: "ZB", state: "Telangana", district: "Sangareddy", zone: "SCR", category: "C" },
    { name: "Gajwel", code: "GJWL", state: "Telangana", district: "Medak", zone: "SCR", category: "D" },
    { name: "Kulkacharla", code: "KLKA", state: "Telangana", district: "Medak", zone: "SCR", category: "D" },
    { name: "Shankarpalli", code: "SKPL", state: "Telangana", district: "Vikarabad", zone: "SCR", category: "D" },

    // 🏛️ NALGONDA DIVISION
    { name: "Nalgonda", code: "NLGD", state: "Telangana", district: "Nalgonda", zone: "SCR", category: "B" },
    { name: "Miryalaguda", code: "MRGA", state: "Telangana", district: "Nalgonda", zone: "SCR", category: "B" },
    
    // 🌾 ANDHRA PRADESH
            { name: "Vijayawada Junction", code: "BZA", state: "Andhra Pradesh", district: "Krishna", zone: "SCR" },
            { name: "Visakhapatnam", code: "VSKP", state: "Andhra Pradesh", district: "Visakhapatnam", zone: "ECoR" },
            { name: "Tirupati", code: "TPTY", state: "Andhra Pradesh", district: "Chittoor", zone: "SCR" },
            { name: "Guntur Junction", code: "GNT", state: "Andhra Pradesh", district: "Guntur", zone: "SCR" },
            { name: "Rajahmundry", code: "RJY", state: "Andhra Pradesh", district: "East Godavari", zone: "SCR" },
            { name: "Nellore", code: "NLR", state: "Andhra Pradesh", district: "Nellore", zone: "SCR" },
            
            // 🏔️ KOLKATA & WEST BENGAL
            { name: "Howrah Junction", code: "HWH", state: "West Bengal", district: "Howrah", zone: "ER" },
            { name: "Sealdah", code: "SDAH", state: "West Bengal", district: "Kolkata", zone: "ER" },
            { name: "Kolkata", code: "KOAA", state: "West Bengal", district: "Kolkata", zone: "ER" },
            { name: "New Jalpaiguri", code: "NJP", state: "West Bengal", district: "Jalpaiguri", zone: "NFR" },
            { name: "Asansol Junction", code: "ASN", state: "West Bengal", district: "Bardhaman", zone: "ER" },
            { name: "Durgapur", code: "DGR", state: "West Bengal", district: "Bardhaman", zone: "ER" },
            
            // 🕌 LUCKNOW & UTTAR PRADESH
            { name: "Lucknow Junction", code: "LJN", state: "Uttar Pradesh", district: "Lucknow", zone: "NER" },
            { name: "Kanpur Central", code: "CNB", state: "Uttar Pradesh", district: "Kanpur", zone: "NCR" },
            { name: "Allahabad Junction", code: "ALD", state: "Uttar Pradesh", district: "Allahabad", zone: "NCR" },
            { name: "Varanasi Junction", code: "BSB", state: "Uttar Pradesh", district: "Varanasi", zone: "NER" },
            { name: "Agra Cantonment", code: "AGC", state: "Uttar Pradesh", district: "Agra", zone: "NCR" },
            { name: "Gorakhpur Junction", code: "GKP", state: "Uttar Pradesh", district: "Gorakhpur", zone: "NER" },
            
            // 🌸 JAIPUR & RAJASTHAN
            { name: "Jaipur Junction", code: "JP", state: "Rajasthan", district: "Jaipur", zone: "NWR" },
            { name: "Jodhpur Junction", code: "JU", state: "Rajasthan", district: "Jodhpur", zone: "NWR" },
            { name: "Udaipur City", code: "UDZ", state: "Rajasthan", district: "Udaipur", zone: "NWR" },
            { name: "Ajmer Junction", code: "AII", state: "Rajasthan", district: "Ajmer", zone: "NWR" },
            { name: "Bikaner Junction", code: "BKN", state: "Rajasthan", district: "Bikaner", zone: "NWR" },
            { name: "Kota Junction", code: "KOTA", state: "Rajasthan", district: "Kota", zone: "WCR" },
            
            // 🏛️ BHOPAL & MADHYA PRADESH
            { name: "Bhopal Junction", code: "BPL", state: "Madhya Pradesh", district: "Bhopal", zone: "WCR" },
            { name: "Indore Junction", code: "INDB", state: "Madhya Pradesh", district: "Indore", zone: "WCR" },
            { name: "Jabalpur", code: "JBP", state: "Madhya Pradesh", district: "Jabalpur", zone: "WCR" },
            { name: "Gwalior Junction", code: "GWL", state: "Madhya Pradesh", district: "Gwalior", zone: "NCR" },
            { name: "Ujjain Junction", code: "UJN", state: "Madhya Pradesh", district: "Ujjain", zone: "WCR" },
            
            // 🌾 GUJARAT
            { name: "Ahmedabad Junction", code: "ADI", state: "Gujarat", district: "Ahmedabad", zone: "WR" },
            { name: "Surat", code: "ST", state: "Gujarat", district: "Surat", zone: "WR" },
            { name: "Vadodara Junction", code: "BRC", state: "Gujarat", district: "Vadodara", zone: "WR" },
            { name: "Rajkot Junction", code: "RJT", state: "Gujarat", district: "Rajkot", zone: "WR" },
            { name: "Bhavnagar Terminus", code: "BVC", state: "Gujarat", district: "Bhavnagar", zone: "WR" },
            { name: "Gandhinagar Capital", code: "GNC", state: "Gujarat", district: "Gandhinagar", zone: "WR" },
            
            // 🏔️ CHANDIGARH & PUNJAB
            { name: "Chandigarh", code: "CDG", state: "Chandigarh", district: "Chandigarh", zone: "NR" },
            { name: "Amritsar Junction", code: "ASR", state: "Punjab", district: "Amritsar", zone: "NR" },
            { name: "Ludhiana Junction", code: "LDH", state: "Punjab", district: "Ludhiana", zone: "NR" },
            { name: "Jalandhar City", code: "JRC", state: "Punjab", district: "Jalandhar", zone: "NR" },
            { name: "Patiala", code: "PTA", state: "Punjab", district: "Patiala", zone: "NR" },
            
            // 🏔️ JAMMU & KASHMIR
            { name: "Jammu Tawi", code: "JAT", state: "Jammu and Kashmir", district: "Jammu", zone: "NR" },
            { name: "Udhampur", code: "UHP", state: "Jammu and Kashmir", district: "Udhampur", zone: "NR" },
            { name: "Katra", code: "KTRA", state: "Jammu and Kashmir", district: "Reasi", zone: "NR" },
            
            // 🌊 BHUBANESWAR & ODISHA
            { name: "Bhubaneswar", code: "BBS", state: "Odisha", district: "Khordha", zone: "ECoR" },
            { name: "Cuttack", code: "CTC", state: "Odisha", district: "Cuttack", zone: "ECoR" },
            { name: "Puri", code: "PURI", state: "Odisha", district: "Puri", zone: "ECoR" },
            { name: "Berhampur", code: "BAM", state: "Odisha", district: "Ganjam", zone: "ECoR" },
            { name: "Rourkela", code: "ROU", state: "Odisha", district: "Sundargarh", zone: "ECoR" },
            
            // 🏔️ PATNA & BIHAR
            { name: "Patna Junction", code: "PNBE", state: "Bihar", district: "Patna", zone: "ECR" },
            { name: "Gaya Junction", code: "GAYA", state: "Bihar", district: "Gaya", zone: "ECR" },
            { name: "Muzaffarpur Junction", code: "MFP", state: "Bihar", district: "Muzaffarpur", zone: "ECR" },
            { name: "Darbhanga Junction", code: "DBG", state: "Bihar", district: "Darbhanga", zone: "ECR" },
            { name: "Bhagalpur", code: "BGP", state: "Bihar", district: "Bhagalpur", zone: "ECR" },
            
            // 🏔️ RANCHI & JHARKHAND
            { name: "Ranchi", code: "RNC", state: "Jharkhand", district: "Ranchi", zone: "SER" },
            { name: "Dhanbad Junction", code: "DHN", state: "Jharkhand", district: "Dhanbad", zone: "ECR" },
            { name: "Bokaro Steel City", code: "BKSC", state: "Jharkhand", district: "Bokaro", zone: "SER" },
            { name: "Jamshedpur", code: "TATA", state: "Jharkhand", district: "East Singhbhum", zone: "SER" },
            
            // 🏔️ DEHRADUN & UTTARAKHAND
            { name: "Dehradun", code: "DDN", state: "Uttarakhand", district: "Dehradun", zone: "NR" },
            { name: "Haridwar", code: "HW", state: "Uttarakhand", district: "Haridwar", zone: "NR" },
            { name: "Rishikesh", code: "RKSH", state: "Uttarakhand", district: "Dehradun", zone: "NR" },
            { name: "Kathgodam", code: "KGM", state: "Uttarakhand", district: "Nainital", zone: "NER" },
            
            // 🏔️ SHIMLA & HIMACHAL PRADESH
            { name: "Kalka", code: "KLK", state: "Haryana", district: "Panchkula", zone: "NR" },
            { name: "Shimla", code: "SML", state: "Himachal Pradesh", district: "Shimla", zone: "NR" },
            { name: "Una Himachal", code: "UHL", state: "Himachal Pradesh", district: "Una", zone: "NR" },
            
            // 🌊 GOA
            { name: "Madgaon Junction", code: "MAO", state: "Goa", district: "South Goa", zone: "KR" },
            { name: "Vasco Da Gama", code: "VSG", state: "Goa", district: "South Goa", zone: "KR" },
            { name: "Thivim", code: "THVM", state: "Goa", district: "North Goa", zone: "KR" },
            
            // 🏔️ NORTHEAST STATES
            { name: "Guwahati", code: "GHY", state: "Assam", district: "Kamrup", zone: "NFR" },
            { name: "Dibrugarh", code: "DBRG", state: "Assam", district: "Dibrugarh", zone: "NFR" },
            { name: "Jorhat Town", code: "JTTN", state: "Assam", district: "Jorhat", zone: "NFR" },
            { name: "Silchar", code: "SCL", state: "Assam", district: "Cachar", zone: "NFR" },
            { name: "Agartala", code: "AGTL", state: "Tripura", district: "West Tripura", zone: "NFR" },
            
            // 🏛️ RAIPUR & CHHATTISGARH
            { name: "Raipur Junction", code: "R", state: "Chhattisgarh", district: "Raipur", zone: "SECR" },
            { name: "Bilaspur Junction", code: "BSP", state: "Chhattisgarh", district: "Bilaspur", zone: "SECR" },
            { name: "Durg", code: "DURG", state: "Chhattisgarh", district: "Durg", zone: "SECR" },
            { name: "Korba", code: "KRBA", state: "Chhattisgarh", district: "Korba", zone: "SECR" }
        ];

        // Autocomplete functionality
        function setupAutocomplete(inputId, suggestionsId) {
            const input = document.getElementById(inputId);
            const suggestionsContainer = document.getElementById(suggestionsId);
            let currentFocus = -1;

            input.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                suggestionsContainer.innerHTML = '';
                currentFocus = -1;

                if (!value) {
                    suggestionsContainer.style.display = 'none';
                    return;
                }

                const matches = indianStations.filter(station => 
                    station.code.toLowerCase().includes(value) || 
                    station.name.toLowerCase().includes(value)
                ).slice(0, 8); // Limit to 8 suggestions

                if (matches.length > 0) {
                    matches.forEach((station, index) => {
                        const div = document.createElement('div');
                        div.className = 'autocomplete-suggestion';
                        div.innerHTML = `
                            <span class="station-code">${station.code}</span>
                            <span class="station-name">${station.name}</span>
                        `;
                        
                        div.addEventListener('click', function() {
                            input.value = `${station.code} - ${station.name}`;
                            suggestionsContainer.style.display = 'none';
                        });

                        suggestionsContainer.appendChild(div);
                    });
                    suggestionsContainer.style.display = 'block';
                } else {
                    suggestionsContainer.style.display = 'none';
                }
            });

            // Handle keyboard navigation
            input.addEventListener('keydown', function(e) {
                const suggestions = suggestionsContainer.getElementsByClassName('autocomplete-suggestion');
                
                if (e.keyCode === 40) { // Down arrow
                    e.preventDefault();
                    currentFocus++;
                    if (currentFocus >= suggestions.length) currentFocus = 0;
                    setActive(suggestions);
                } else if (e.keyCode === 38) { // Up arrow
                    e.preventDefault();
                    currentFocus--;
                    if (currentFocus < 0) currentFocus = suggestions.length - 1;
                    setActive(suggestions);
                } else if (e.keyCode === 13) { // Enter
                    e.preventDefault();
                    if (currentFocus > -1 && suggestions[currentFocus]) {
                        suggestions[currentFocus].click();
                    }
                } else if (e.keyCode === 27) { // Escape
                    suggestionsContainer.style.display = 'none';
                    currentFocus = -1;
                }
            });

            function setActive(suggestions) {
                for (let i = 0; i < suggestions.length; i++) {
                    suggestions[i].classList.remove('highlighted');
                }
                if (currentFocus >= 0 && suggestions[currentFocus]) {
                    suggestions[currentFocus].classList.add('highlighted');
                }
            }

            // Hide suggestions when clicking outside
            document.addEventListener('click', function(e) {
                if (!input.contains(e.target) && !suggestionsContainer.contains(e.target)) {
                    suggestionsContainer.style.display = 'none';
                }
            });
        }

        // Form submission with loader
        document.getElementById('sellTicketForm').addEventListener('submit', function(e) {
            const btnText = submitBtn.querySelector('.btn-text');
            const loader = submitBtn.querySelector('.loader');

            // Add loading state
            submitBtn.classList.add('btn-loading');
            submitBtn.disabled = true;
            btnText.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';

            // Optional: You can remove this timeout if you want the loader to show until the actual form submission completes
            // This is just for demonstration purposes
        });

        function addPassenger() {
            const container = document.getElementById('passenger-container');
            const ticketCountInput = document.getElementById('numberOfTickets');
            const maxTickets = parseInt(ticketCountInput.max);

            // Check if we've reached maximum tickets
            if (passengerCount >= maxTickets) {
                alert(`Maximum ${maxTickets} tickets allowed per PNR`);
                return;
            }

            const index = passengerCount++;

            // Increment the ticket count
            ticketCountInput.value = passengerCount;

            const block = document.createElement('div');
            block.className = 'passenger-block';
            block.innerHTML = `
                <button type="button" class="remove-passenger" onclick="removePassenger(this)">
                    <i class="fas fa-times"></i>
                </button>
                <div class="form-group">
                    <label>Passenger Name</label>
                    <input type="text" name="passengerNames[${index}]" required>
                </div>
                <div class="form-group">
                    <label>Gender</label>
                    <select name="genders[${index}]" required>
                        <option value="">-- Select Gender --</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Age</label>
                    <input type="number" name="ages[${index}]" min="1" max="120" required>
                </div>
                <div class="form-group">
                    <label>Coach Class</label>
                    <select name="coaches[${index}]" class="coach-select" data-index="${index}" required onchange="updateSeatOptions(this)">
                        <option value="">-- Select Class --</option>
                        <option value="SL">Sleeper (SL)</option>
                        <option value="3A">AC 3 Tier (3A)</option>
                        <option value="2A">AC 2 Tier (2A)</option>
                        <option value="1A">AC First Class (1A)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Seat Number</label>
                    <select name="seats[${index}]" class="seat-number" id="seat-${index}" required>
                        <option value="">-- Seat Format --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Price (₹)</label>
                    <input type="number" step="0.01" name="prices[${index}]" placeholder="Enter IRCTC ticket price for each passenger" required>
                    <div class="note">Enter the price for each passenger ticket (SINGLE PASSENGER).</div>
                </div>
                <div class="form-group">
                    <label>ID Proof Document</label>
                    <div class="file-input-wrapper">
                        <div class="file-input-btn">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <span>Upload ID Proof</span>
                        </div>
                        <input type="file" name="documentUrls" accept=".jpg,.jpeg,.png" required onchange="showPassengerFileName(this, ${index})">
                    </div>
                    <div class="note">Can be upload a masked document only in jpg, jpeg (e.g., Aadhaar with last 4 digits visible) for each Passenger
                        <a href="/maskedAadhar">Steps</a>
                    </div>
                    <div class="file-name" id="passengerFile${index}"></div>
                </div>
            `;
            container.appendChild(block);
        }

        function removePassenger(button) {
            const container = document.getElementById('passenger-container');
            const block = button.parentNode;
            container.removeChild(block);
            passengerCount--;

            // Update the ticket count
            document.getElementById('numberOfTickets').value = passengerCount;

            // Reindex remaining passengers
            const passengerBlocks = container.getElementsByClassName('passenger-block');
            for (let i = 0; i < passengerBlocks.length; i++) {
                const inputs = passengerBlocks[i].querySelectorAll('input, select');
                inputs.forEach(input => {
                    const name = input.name.replace(/\[\d+\]/, `[${i}]`);
                    input.name = name;
                });

                const fileInput = passengerBlocks[i].querySelector('input[type="file"]');
                if (fileInput) {
                    fileInput.setAttribute('onchange', `showPassengerFileName(this, ${i})`);
                }
            }
        }

        function showFileName(input) {
            const fileNameDisplay = document.getElementById('ticketFileName');
            if (input.files.length > 0) {
                fileNameDisplay.textContent = input.files[0].name;
                fileNameDisplay.style.display = 'block';
            }
        }

        function showPassengerFileName(input, index) {
            const fileNameDisplay = document.getElementById(`passengerFile${index}`);
            if (input.files.length > 0) {
                fileNameDisplay.textContent = input.files[0].name;
                fileNameDisplay.style.display = 'block';
            }
        }

        // Add first passenger by default
        window.onload = function() {
            // Initialize autocomplete for station inputs
            setupAutocomplete('fromStation', 'fromStationSuggestions');
            setupAutocomplete('toStation', 'toStationSuggestions');

            addPassenger();

            // Link number of tickets to passenger count
            document.getElementById('numberOfTickets').addEventListener('change', function() {
                const ticketCount = parseInt(this.value);
                const passengerContainer = document.getElementById('passenger-container');
                const currentPassengers = passengerContainer.children.length;

                if (ticketCount > currentPassengers) {
                    // Add missing passengers
                    for (let i = currentPassengers; i < ticketCount; i++) {
                        addPassenger();
                    }
                } else if (ticketCount < currentPassengers) {
                    // Remove extra passengers
                    while (passengerContainer.children.length > ticketCount) {
                        passengerContainer.removeChild(passengerContainer.lastChild);
                        passengerCount--;
                    }
                }
            });
        };

        function updateSeatOptions(selectElement) {
            const index = selectElement.dataset.index;
            const seatSelect = document.getElementById('seat-' + index);
            const selectedCoach = selectElement.value;

            seatSelect.innerHTML = '<option value="">-- Seat Format --</option>';

            if (selectedCoach === 'SL') {
                generateBerthOptions(seatSelect, 'S', 1, 12, 80);
            } else if (selectedCoach === '3A') {
                generateBerthOptions(seatSelect, 'B', 1, 9, 72);
            } else if (selectedCoach === '2A') {
                generateBerthOptions(seatSelect, 'A', 1, 3, 54);
            } else if (selectedCoach === '1A') {
                generateBerthOptions(seatSelect, 'H', 1, 2, 30);
            }
        }

        function generateBerthOptions(selectElement, prefix, coachStart, coachEnd, maxBerthsPerCoach) {
            for (let i = coachStart; i <= coachEnd; i++) {
                for (let b = 1; b <= maxBerthsPerCoach; b++) {
                    const code = `${prefix}${i}/${b}`;
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = code;
                    selectElement.appendChild(option);
                }
            }
        }
    </script>
</body>
</html>
